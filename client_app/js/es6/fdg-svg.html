<script type="text/javascript">
//No need for a template or shadow dom because we use vdom.
(() => {
    const {
        render,
        El
    } = require('./vdom.js');
    const { renderGraph } = require('./render.graph.js');
    const { fdg } = require('./fdg.js');


    class FdgSvg extends HTMLElement {
        createdCallback() {
            let prev = null;
            this.render = (tree) => {
                let next;
                if (!tree) {
                    next = El('h1', {}, 'No graph loaded');
                } else {
                    next = renderGraph(tree);
                }
                render(document, this, next, prev);
                prev = next;
            };
        }
        attachedCallback() {
            this.innerHTML = '';
            this.subscription = fdg.subscribe(this.render);
        }
        detachedCallback() {
            this.subscription();
        }
    }

    document.registerElement('fdg-svg', FdgSvg);

})();

</script>
